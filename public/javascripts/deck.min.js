"use strict";var Deck=function(){function n(n,e){var o=Date.now(),r=o+n,i=r+e,u={start:r,end:i};g.push(u),b||(b=!0,requestAnimationFrame(t));var a={start:function(n){return u.startcb=n,a},progress:function(n){return u.progresscb=n,a},end:function(n){return u.endcb=n,a}};return a}function t(){var n=Date.now();if(1e3/60>n-w)return void requestAnimationFrame(t);if(w=n,!g.length)return void(b=!1);for(var e,o=0;o<g.length;o++)if(e=g[o],!(n<e.start)){e.started||(e.started=!0,e.startcb&&e.startcb());var r=(n-e.start)/(e.end-e.start);e.progresscb&&e.progresscb(1>r?r:1),n>e.end&&(e.endcb&&e.endcb(),g.splice(o--,1))}requestAnimationFrame(t)}function e(n){if("undefined"!=typeof A[n])return A[n];if("undefined"!=typeof C[n])return A[n]=n,n;for(var t,e=n[0].toUpperCase()+n.slice(1),o=["webkit","moz","Moz","ms","o"],r=0,i=o.length;i>r;r++)if(t=o[r]+e,"undefined"!=typeof C[t])return A[n]=t,t}function o(n,t,e){return"undefined"!=typeof k||(k=r()),e=e||0,k?"translate3d("+n+", "+t+", "+e+")":"translate("+n+", "+t+")"}function r(){var n=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(!n)return!1;var t=e("transform"),o=document.createElement("p");return document.body.appendChild(o),o.style[t]="translate3d(1px,1px,1px)",k=o.style[t],k=null!=k&&k.length&&"none"!==k,document.body.removeChild(o),k}function i(n,t){var e=Date.now(),o=e+n,r=o+t,i={start:o,end:r};I.push(i),q||(q=!0,requestAnimationFrame(u));var a={start:function(n){return i.startcb=n,a},progress:function(n){return i.progresscb=n,a},end:function(n){return i.endcb=n,a}};return a}function u(){var n=Date.now();if(1e3/60>n-M)return void requestAnimationFrame(u);if(M=n,!I.length)return void(q=!1);for(var t,e=0;e<I.length;e++)if(t=I[e],!(n<t.start)){t.started||(t.started=!0,t.startcb&&t.startcb());var o=(n-t.start)/(t.end-t.start);t.progresscb&&t.progresscb(1>o?o:1),n>t.end&&(t.endcb&&t.endcb(),I.splice(e--,1))}requestAnimationFrame(u)}function a(n){return document.createElement(n)}function c(n){function t(n){n.card&&n.card(C)}function r(n){function t(n){k&&("mousemove"===n.type?(i.x=n.clientX,i.y=n.clientY):(i.x=n.touches[0].clientX,i.y=n.touches[0].clientY),b.style[m]=o(Math.round(C.x+i.x-r.x)+"px",Math.round(C.y+i.y-r.y)+"px")+(C.rot?" rotate("+C.rot+"deg)":""))}function e(n){q&&Date.now()-u<200&&C.setSide("front"===C.side?"back":"front"),"mouseup"===n.type?(f(window,"mousemove",t),f(window,"mouseup",e)):(f(window,"touchmove",t),f(window,"touchend",e)),k&&(C.x=C.x+i.x-r.x,C.y=C.y+i.y-r.y)}var r={},i={},u=Date.now();n.preventDefault(),"mousedown"===n.type?(r.x=i.x=n.clientX,r.y=i.y=n.clientY,s(window,"mousemove",t),s(window,"mouseup",e)):(r.x=i.x=n.touches[0].clientX,r.y=i.y=n.touches[0].clientY,s(window,"touchmove",t),s(window,"touchend",e)),k&&(b.style[m]=o(C.x+"px",C.y+"px")+(C.rot?" rotate("+C.rot+"deg)":""),b.style.zIndex=O++)}function u(n){n.appendChild(b),C.$root=n}function c(){C.$root&&C.$root.removeChild(b),C.$root=null}function l(n){"front"===n?("back"===C.side&&b.removeChild(w),C.side="front",b.appendChild(g),C.setRankSuit(C.rank,C.suit)):("front"===C.side&&b.removeChild(g),C.side="back",b.appendChild(w),b.setAttribute("class","card"))}var p,m=e("transform"),y=n%13+1,v=n/13|0,h=(52-n)/4,b=a("div"),g=a("div"),w=a("div"),k=!1,q=!1,C={i:n,rank:y,suit:v,pos:n,$el:b,mount:u,unmount:c,setSide:l},A=x.modules;g.classList.add("face"),w.classList.add("back"),b.style[m]=o(-h+"px",-h+"px"),C.x=-h,C.y=-h,C.z=h,C.rot=0,C.setSide("back"),s(b,"mousedown",r),s(b,"touchstart",r);for(p in A)t(A[p]);return C.animateTo=function(n){var t,e,r,u,a,c,d=n.delay,s=n.duration,f=n.x,l=void 0===f?C.x:f,p=n.y,y=void 0===p?C.y:p,v=n.rot,h=void 0===v?C.rot:v,x=n.ease,g=n.onStart,w=n.onProgress,k=n.onComplete;i(d,s).start(function(){t=C.x||0,e=C.y||0,r=C.rot||0,g&&g()}).progress(function(n){var i=D[x||"cubicInOut"](n);u=l-t,a=y-e,c=h-r,w&&w(n,i),C.x=t+u*i,C.y=e+a*i,C.rot=r+c*i,b.style[m]=o(C.x+"px",C.y+"px")+(c?"rotate("+C.rot+"deg)":"")}).end(function(){k&&k()})},C.setRankSuit=function(n,t){var e=d(t);b.setAttribute("class","card "+e+" rank"+n)},C.setRankSuit(y,v),C.enableDragging=function(){k||(k=!0,b.style.cursor="move")},C.enableFlipping=function(){q||(q=!0)},C.disableFlipping=function(){q&&(q=!1)},C.disableDragging=function(){k&&(k=!1,b.style.cursor="")},C}function d(n){return 0===n?"spades":1===n?"hearts":2===n?"clubs":3===n?"diamonds":"joker"}function s(n,t,e){n.addEventListener(t,e)}function f(n,t,e){n.removeEventListener(t,e)}function l(n){var t=Math.round(Math.random())?-1:1;return t*n}function p(n){for(var t,e,o=n.length-1;o;o--)t=Math.random()*o|0,e=n[o],n[o]=n[t],n[t]=e;return n}function m(){return window.getComputedStyle(document.body).getPropertyValue("font-size").slice(0,-2)}function y(n){return n*Math.PI/180}function v(n){function t(n){return function(){var t=this,o=arguments;e(function(e){n.apply(t,r.concat.apply(e,o))})}}function e(n){n&&(i.push(n),1===i.length&&o())}function o(){i[0](function(n){if(n)throw n;i=i.slice(1),i.length&&o()})}var r=Array.prototype,i=[];return n.queue=e,n.queued=t,n}function h(n){function t(n,t,e){i[n]||(i[n]=[]),i[n].push({cb:t,ctx:e})}function e(n,t,e){i[n]||(i[n]=[]),i[n].push({cb:t,ctx:e,once:!0})}function o(n){var t=this,e=Array.prototype.slice(arguments,1),o=i[n]||[];o.filter(function(n){return n.cb.apply(t,e),!n.once})}function r(n,t){return n?t?void(i[n]=i[n].filter(function(n){return n.cb!==t})):void(i[n]=[]):void(i={})}n||(n={});var i={};return n.on=t,n.one=e,n.off=r,n.trigger=o,n}function x(n){function t(n){r=n,r.appendChild(d)}function e(){r.removeChild(d)}function o(n){n.deck&&n.deck(s)}var r,i,u=new Array(n?55:52),d=a("div"),s=h({mount:t,unmount:e,cards:u,$el:d}),f=x.modules;v(s);for(i in f)o(f[i]);d.classList.add("deck");for(var l,p=u.length;p;p--)l=u[p-1]=c(p-1),l.mount(d);return s}var b,g=[],w=0;window.requestAnimationFrame||(window.requestAnimationFrame=function(n){setTimeout(n,0)});var k,q,C=document.createElement("p").style,A={},I=[],M=0;window.requestAnimationFrame||(window.requestAnimationFrame=function(n){setTimeout(n,0)});var S,E,F,T,O=52,D={linear:function(n){return n},quadIn:function(n){return n*n},quadOut:function(n){return n*(2-n)},quadInOut:function(n){return.5>n?2*n*n:-1+(4-2*n)*n},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return.5>n?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},quartIn:function(n){return n*n*n*n},quartOut:function(n){return 1- --n*n*n*n},quartInOut:function(n){return.5>n?8*n*n*n*n:1-8*--n*n*n*n},quintIn:function(n){return n*n*n*n*n},quintOut:function(n){return 1+--n*n*n*n*n},quintInOut:function(n){return.5>n?16*n*n*n*n*n:1+16*--n*n*n*n*n}},$={deck:function(n){function t(t){var e=n.cards.filter(function(n){return"front"===n.side}).length/n.cards.length;n.cards.forEach(function(n,t){n.setSide(e>.5?"back":"front")}),t()}n.flip=n.queued(t)}},z={deck:function(n){function t(t,e){var o=n.cards;o.sort(function(n,t){return e?n.i-t.i:t.i-n.i}),o.forEach(function(n,r){n.sort(r,o.length,function(n){n===o.length-1&&t()},e)})}n.sort=n.queued(t)},card:function(n){var t=n.$el;n.sort=function(e,o,r,i){var u=e/4,a=10*e;n.animateTo({delay:a,duration:400,x:-u,y:-150,rot:0,onComplete:function(){t.style.zIndex=e}}),n.animateTo({delay:a+500,duration:400,x:-u,y:-u,rot:0,onComplete:function(){r(e)}})}}},P={deck:function(n){function t(t){var e=n.cards;S=m(),p(e),e.forEach(function(n,o){n.pos=o,n.shuffle(function(n){n===e.length-1&&t()})})}n.shuffle=n.queued(t)},card:function(n){var t=n.$el;n.shuffle=function(e){var o=n.pos,r=o/4,i=2*o;n.animateTo({delay:i,duration:200,x:l(40*Math.random()+20)*S/16,y:-r,rot:0}),n.animateTo({delay:200+i,duration:200,x:-r,y:-r,rot:0,onStart:function(){t.style.zIndex=o},onComplete:function(){e(o)}})}}},L={deck:function(n){function t(t){var e=n.cards,o=e.length;E=m(),e.slice(-5).reverse().forEach(function(n,e){n.poker(e,o,function(e){n.setSide("front"),4===e&&t()})})}n.poker=n.queued(t)},card:function(n){var t=n.$el;n.poker=function(e,o,r){var i=250*e;n.animateTo({delay:i,duration:250,x:Math.round(70*(e-2.05)*E/16),y:Math.round(-110*E/16),rot:0,onStart:function(){t.style.zIndex=o-1+e},onComplete:function(){r(e)}})}}},X={deck:function(t){function e(e){var o=t.cards;o.forEach(function(t,r){t.setSide("front"),t.intro(r,function(r){n(250,0).start(function(){t.setSide("back")}),r===o.length-1&&e()})})}t.intro=t.queued(e)},card:function(n){var t=e("transform"),r=n.$el;n.intro=function(e,i){var u=500+10*e,a=e/4;r.style[t]=o(-a+"px","-250px"),r.style.opacity=0,n.x=-a,n.y=-250-a,n.rot=0,n.animateTo({delay:u,duration:1e3,x:-a,y:-a,onStart:function(){r.style.zIndex=e},onProgress:function(n){r.style.opacity=n},onComplete:function(){r.style.opacity="",i&&i(e)}})}}},Y={deck:function(n){function t(t){var e=n.cards,o=e.length;F=m(),e.forEach(function(n,r){n.fan(r,o,function(n){n===e.length-1&&t()})})}n.fan=n.queued(t)},card:function(n){n.fan=function(t,e,o){var r=t/4,i=10*t,u=t/(e-1)*260-130;n.animateTo({delay:i,duration:300,x:-r,y:-r,rot:0}),n.animateTo({delay:300+i,duration:300,x:55*Math.cos(y(u-90))*F/16,y:55*Math.sin(y(u-90))*F/16,rot:u,onComplete:function(){o(t)}})}}},R={deck:function(n){function t(t){var e=n.cards;T=m(),e.forEach(function(n){n.bysuit(function(n){n===e.length-1&&t()})})}n.bysuit=n.queued(t)},card:function(n){var t=n.rank,e=n.suit;n.bysuit=function(o){var r=n.i,i=10*r;n.animateTo({delay:i,duration:400,x:-Math.round(8*(6.75-t)*T/16),y:-Math.round(92*(1.5-e)*T/16),rot:0,onComplete:function(){o(r)}})}}};return x.animationFrames=n,x.ease=D,x.modules={bysuit:R,fan:Y,intro:X,poker:L,shuffle:P,sort:z,flip:$},x.Card=c,x.prefix=e,x.translate=o,x}();